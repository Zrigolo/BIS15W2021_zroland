filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy, color=country))+ geom_point() +geom_line()
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy, color=country))+ geom_line()+ geom_point(shape=1)+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy, color=country))+ geom_line()+ geom_point(shape=1)+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 90, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy, color=country))+ geom_line()+ geom_point(shape=1)+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 70, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy, color=country))+ geom_line()+coord_flip() +geom_point(shape=1)+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 70, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy, color=country))+ geom_line()+coord_flip() +geom_point(shape=1)+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 0, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy, color=country))+ geom_line()+geom_point(shape=1)+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy, color=country))+ geom_line()+geom_point()+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy,group=country, color=country))+ geom_line()+geom_point()+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy,group=country, color=country))+ geom_line()+geom_point(alpha(0.2))+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait" |country== "Kyrgyz Republic" |country== "Turkmenistan" |country== "South Korea" |country== "Tajikistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy,group=country, color=country))+ geom_line()+geom_point()+ labs(title = "Life Expectancy between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
knitr::opts_chunk$set(echo = TRUE)
population %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_pop = "1920", final_pop = "2020") %>%
mutate(change_pop = final_pop - initial_pop) %>%
arrange(desc(change_pop))
life_expectancy %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_le = "1920", final_le = "2020") %>%
mutate(change_le = final_le - initial_le) %>%
arrange(desc(change_le))
library(tidyverse)
library(janitor)
library(here)
options(scipen=999) #disables scientific notation when printing
life_expectancy %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_le = "1920", final_le = "2020") %>%
mutate(change_le = final_le - initial_le) %>%
arrange(desc(change_le))
population %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_pop = "1920", final_pop = "2020") %>%
mutate(change_pop = final_pop - initial_pop) %>%
arrange(desc(change_pop))
population_tidy %>%
filter(country== "India" |country== "China" |country== "Indonesia" |country== "United States" |country== "Pakistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=population,group=country, color=country))+ geom_line()+geom_point()+ labs(title = "Population Growth Between 1920 and 2020", x = "Year", y= "Population")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
income %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_inc = "1920", final_inc = "2020") %>%
mutate(change_inc = final_inc - initial_inc) %>%
arrange(desc(change_inc))
income_tidy %>%
filter(country== "Qatar" |country== "Luxembourg" |country== "Singapore" |country== "Brunei" |country== "Ireland") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=income,group=country, color=country))+ geom_line()+geom_point()+ labs(title = "Income Growth Between 1920 and 2020", x = "Year", y= "Income")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
life_expectancy_tidy %>%
filter(country== "Kuwait") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy,group=country, color=country))+ geom_line()+geom_point()+ labs(title = "Life Expectancy Between 1920 and 2020", x = "Year", y= "Age (years)")+ theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
population_tidy %>%
filter(country== "India" |country== "China" |country== "Indonesia" |country== "United States" |country== "Pakistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=population,group=country, color=country))+
geom_line()+
geom_point()+
labs(title = "Population Growth Between 1920 and 2020", x = "Year", y= "Population")+
scale_x_discrete(breaks=c(1920,1940,1960,1980,2000,2020))+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
population_tidy %>%
filter(country== "India" |country== "China" |country== "Indonesia" |country== "United States" |country== "Pakistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=population,group=country, color=country))+
geom_line()+
geom_point()+
labs(title = "Population Growth Between 1920 and 2020", x = "Year", y= "Population")+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
population_tidy %>%
filter(country== "India" |country== "China" |country== "Indonesia" |country== "United States" |country== "Pakistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=population,group=1, color=country))+
geom_line()+
geom_point()+
labs(title = "Population Growth Between 1920 and 2020", x = "Year", y= "Population")+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
population_tidy %>%
filter(country== "India" |country== "China" |country== "Indonesia" |country== "United States" |country== "Pakistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=population,group=country, color=country))+
geom_line()+
geom_point()+
labs(title = "Population Growth Between 1920 and 2020", x = "Year", y= "Population")+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
income_tidy %>%
filter(country== "Qatar" |country== "Luxembourg" |country== "Singapore" |country== "Brunei" |country== "Ireland") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=income,group=country, color=country))+
geom_line()+
geom_point()+
labs(title = "Income Growth Between 1920 and 2020", x = "Year", y= "Income")+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))
life_expectancy_tidy %>%
filter(country== "Kuwait") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy,group=country, color=country))+
geom_line()+geom_point()+
labs(title = "Life Expectancy Between 1920 and 2020", x = "Year", y= "Age (years)")+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))
life_expectancy %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_le = "1920", final_le = "2020") %>%
mutate(change_le = final_le - initial_le) %>%
filter(change_le>54.2) %>%
arrange(desc(change_le))
population %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_pop = "1920", final_pop = "2020") %>%
mutate(change_pop = final_pop - initial_pop) %>%
filter(change_pop>)
population %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_pop = "1920", final_pop = "2020") %>%
mutate(change_pop = final_pop - initial_pop) %>%
filter(change_pop>185400000) %>%
arrange(desc(change_pop))
income %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_inc = "1920", final_inc = "2020") %>%
mutate(change_inc = final_inc - initial_inc) %>%
filter(change_inc>63210) %>%
arrange(desc(change_inc))
Life_expectancy_100<-life_expectancy_tidy%>%
filter(year<=2020&year>=1920)
Life_expectancy_100<-life_expectancy_tidy%>%
filter(year<=2020&year>=1920)
Life_expectancy_100<-life_expectancy_tidy%>%
filter(year<=2020&year>=1920)
Life_expectancy_100
Population_100<-population_tidy%>%
filter(year<=2020&year>=1920)
Population_100<-population_tidy%>%
filter(year<=2020&year>=1920)
income_100<-income_tidy%>%
filter(year<=2020&year>=1920)
gapminder_join <- inner_join(life_expectancy_100, population_100, by= c("country", "year"))
population_100<-population_tidy%>%
filter(year<=2020&year>=1920)
life_expectancy_100<-life_expectancy_tidy%>%
filter(year<=2020&year>=1920)
life_expectancy_100<-life_expectancy_tidy%>%
filter(year<=2020&year>=1920)
population_100<-population_tidy%>%
filter(year<=2020&year>=1920)
income_100<-income_tidy%>%
filter(year<=2020&year>=1920)
gapminder_join <- inner_join(life_expectancy_100, population_100, by= c("country", "year"))
gapminder_join <- inner_join(gapminder_join, income_100, by= c("country", "year"))
gapminder_join
summary(gapminder_join)
glimpse(gapminder_join)
gapminder_join %>%
filter(year=2020)
gapminder_join %>%
filter(year=+2020)
gapminder_join %>%
filter(year==2020)
gapminder_join %>%
filter(year==2020,year!= NA)
gapminder_join %>%
filter(year==2020, year!= "NA")
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=life_expectancy, y=income))+geom_point()
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=income, y=life_expectancy))+geom_point()
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=income, y=life_expectancy, fill=country))+geom_point()
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=income, y=life_expectancy))+geom_point()
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=income, y=life_expectancy))+geom_point()+ geom_smooth(method+lm)
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=income, y=life_expectancy))+geom_point()+ geom_smooth(method=lm)
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+geom_point()+ geom_smooth(method=lm)
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point()+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))+
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point()+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point()+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 0, hjust = 0), plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point()+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP per Person", y= "Life Expectancy (years)")+
theme(axis.text.x =  plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point()+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point()+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP per Person", y= "Life Expectancy (years)")+
theme(axis.text.x =plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point()+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 0, hjust = 0), plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point()+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP Per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 0, hjust = 0), plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point(color=Red)+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP Per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 0, hjust = 0), plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point(alpha=0.4, color= "olivedrab4")+
geom_smooth(method=lm)+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP Per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 0, hjust = 0), plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point(alpha=0.4, color= "olivedrab4")+
geom_smooth(method=lm,color= "grey50")+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP Per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 0, hjust = 0), plot.title = element_text(size = rel(1.5), hjust = 0.5))
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point(alpha=0.8, color= "olivedrab4")+
geom_smooth(method=lm,color= "grey50")+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP Per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 0, hjust = 0), plot.title = element_text(size = rel(1.5), hjust = 0.5))
income_tidy %>%
filter(country== "Qatar" |country== "Luxembourg" |country== "Singapore" |country== "Brunei" |country== "Ireland") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=income,group=country, color=country))+
geom_line()+
geom_point()+
labs(title = "GDP Growth Between 1920 and 2020", x = "Year", y= "Income")+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))
income_tidy %>%
filter(country== "Qatar" |country== "Luxembourg" |country== "Singapore" |country== "Brunei" |country== "Ireland") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=income,group=country, color=country))+
geom_line()+
geom_point()+
labs(title = "GDP Growth Between 1920 and 2020", x = "Year", y= "GDP")+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))
life_expectancy_tidy %>%
filter(country= "Andorra")
life_expectancy_tidy %>%
filter(country=+ "Andorra")
life_expectancy_tidy %>%
filter(country== "Andorra")
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
filter(life_expectancy!=NA) %>%
summarize(mean_le= mean(life_expectancy)) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy),na.rm=T) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy,na.rm=T)) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy, na.rm=T)) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020),life_expectancy != NA) %>%
summarize(mean_le= mean(life_expectancy)) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020),life_expectancy != "NA") %>%
summarize(mean_le= mean(life_expectancy)) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
filter(life_expectancy =! NA)
life_expectancy_tidy %>%
filter(life_expectancy != NA)
life_expectancy_tidy %>%
naniar::miss_var_summary()
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy, na.rm = T)) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
filter(country== "Andorra")
life_expectancy_tidy %>%
filter(country== "Spain"
life_expectancy_tidy %>%
filter(country== "Spain")
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy)na.rm = T) %>%
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy),na.rm = T) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy),na.rm = T) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy)) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy)) %>%
arrange(mean_le)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
options(scipen=999) #disables scientific notation when printing
population <- read_csv("data/population_total.csv")
population
income <- read_csv("data/income_per_person_gdppercapita_ppp_inflation_adjusted.csv")
income
life_expectancy <- read_csv("data/life_expectancy_years.csv")
life_expectancy
income_tidy<- income %>%
pivot_longer(-country,names_to = "year", values_to ="income" )
income_tidy
population_tidy<- population %>%
pivot_longer(-country,names_to = "year", values_to ="population" )
population_tidy
life_expectancy_tidy<- life_expectancy %>%
pivot_longer(-country,names_to = "year", values_to ="life_expectancy" )
life_expectancy_tidy
population %>%
summarise(n_countries_pop=n_distinct(country),
countries_pop= country)
income %>%
summarise(n_countries_inc=n_distinct(country),
countries_inc= country)
life_expectancy %>%
summarise(n_countries_le=n_distinct(country),
countries_le= country)
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy)) %>%
arrange(desc(mean_le))
life_expectancy_tidy %>%
group_by(country) %>%
filter(between(year, 1920,2020)) %>%
summarize(mean_le= mean(life_expectancy)) %>%
arrange(mean_le)
life_expectancy %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_le = "1920", final_le = "2020") %>%
mutate(change_le = final_le - initial_le) %>%
filter(change_le>54.2) %>%
arrange(desc(change_le))
life_expectancy_tidy %>%
filter(country== "Kuwait") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=life_expectancy,group=country, color=country))+
geom_line()+geom_point()+
labs(title = "Life Expectancy Between 1920 and 2020", x = "Year", y= "Age (years)")+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))
population %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_pop = "1920", final_pop = "2020") %>%
mutate(change_pop = final_pop - initial_pop) %>%
filter(change_pop>185400000) %>%
arrange(desc(change_pop))
population_tidy %>%
filter(country== "India" |country== "China" |country== "Indonesia" |country== "United States" |country== "Pakistan") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=population,group=country, color=country))+
geom_line()+
geom_point()+
labs(title = "Population Growth Between 1920 and 2020", x = "Year", y= "Population")+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))
income %>%
select(country, "1920","2020") %>%
group_by(country) %>%
rename(initial_inc = "1920", final_inc = "2020") %>%
mutate(change_inc = final_inc - initial_inc) %>%
filter(change_inc>63210) %>%
arrange(desc(change_inc))
income_tidy %>%
filter(country== "Qatar" |country== "Luxembourg" |country== "Singapore" |country== "Brunei" |country== "Ireland") %>%
filter(between(year,"1920","2020")) %>%
ggplot(aes(x=year,y=income,group=country, color=country))+
geom_line()+
geom_point()+
labs(title = "GDP Growth Between 1920 and 2020", x = "Year", y= "GDP")+
theme(axis.text.x = element_text(angle = 60, hjust = 1), plot.title = element_text(size = rel(1.5), hjust = 0.5))+
scale_x_discrete(breaks=c(1920,1930,1940,1950,1960,1970,1980,1990,2000,2010,2020))
life_expectancy_100<-life_expectancy_tidy%>%
filter(year<=2020&year>=1920)
population_100<-population_tidy%>%
filter(year<=2020&year>=1920)
income_100<-income_tidy%>%
filter(year<=2020&year>=1920)
gapminder_join <- inner_join(life_expectancy_100, population_100, by= c("country", "year"))
gapminder_join <- inner_join(gapminder_join, income_100, by= c("country", "year"))
gapminder_join
gapminder_join %>%
filter(year==2020) %>%
ggplot(aes(x=log10(income), y=life_expectancy))+
geom_point(alpha=0.8, color= "olivedrab4")+
geom_smooth(method=lm,color= "grey50")+
labs(title = "The Relationship Between Income and Life Expectancy in 2020", x = "Log of GDP Per Person", y= "Life Expectancy (years)")+
theme(axis.text.x = element_text(angle = 0, hjust = 0), plot.title = element_text(size = rel(1.5), hjust = 0.5))
